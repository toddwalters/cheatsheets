# Windows Python VirtualEnv Install & Use in Microsoft PowerShell and Visual Studio Code

**Note:** I had to install **`pip`** and **`virtualenv`** at home.  I could never successfully get these to install while at work sitting behind the corporate proxy.  Maybe I just wasn't patient enough.  Once these two binaries were installed I was able to get everything thing working, but in a pretty flaky way (see below). 

- After installing the installing the Windows Python **`virtualenv`** module I ran into the following bug:  [PowerTab module dependency causing errors on initialization](https://bitbucket.org/guillermooo/virtualenvwrapper-powershell/issues/9/powertab-module-dependency-causing-errors) and had to update the **`VirtualenvWrapperTabExpansion.psm1`** file.  This bug is related to a non-critical Warning that appears when you import the virtualenvwrapper module in your powershell session.

- I was able to start a python virtual env within PS.
 
    Itâ€™s was indeed a little flakey, I also needed to continue to hit https://pypi.python.org in a browswer while at the same time trying to create the virtual environments as well as execute **`pip install`** commands within the virtual environment.  If I did not do the constant browser refresh then both the virtual environment creation and pip installs wihtin the virtual environments would fail.

    As, Matt B. mentioned this behavior is probably be due to different source address spaces:  "There are apparently some address spaces (deemed "datacenter" server networks) for which proxy access is unauthenticated.  Other address spaces require proxy authentication, the thing that happens transparently when you hit an endpoint via a web browser, and that has a several-minute lifespan."

- I also did have to set http proxy environment variables in order for things to work.

**`PS > $env:HTTPS_PROXY = "10.20.30.40:9000"`**

**`PS > New-VirtualEnvironment proj_foo`**

```
PS > New-VirtualEnvironment fubar01

PS C:\pub> New-VirtualEnvironment fubar01
New python executable in C:\pub\.virtualenvs\fubar01\Scripts\python.exe
Installing setuptools, pip, wheel...done.
Added activation script por Powershell to C:\pub\.virtualenvs/fubar01\Scripts.
(fubar01)PS C:\pub>
```

I was also able to get [Microsoft Visual Studio Code](https://code.visualstudio.com/) to recognize that my project was using a Python Virtual Environment as well.  If you haven't tried VS Code, you should.  Much better than Sublime or Atom, though if you are only doing PYthon development PyCharm is probably still the best way to go :-)

Within your source code folder you need to create a .vscode folder and you need to create or have vscode create three vscode configuration files:  **`settings.json, tasks.json, and launch.json`** 
(see links **[2],[3],[5],[6], and [7]** below).

This directory contains sample vscode workspace files that can be placed within a source code directory tree in the **`.vscode`** directory that will allow vscode to understand how to deal with Python Virtual Enviroments.

In each of the files within the .vscode directory replace **`C:/pub/.virtualenvs/{virt-env-name}`** with the fully qualified path to the python virtual environment associated with project whose source code you are working.

**Note:** nothing needs to be modified in the **`launch.json`** file as it actually honors the variable that is updated in the **`settings.json`** file.  The **`launch.json`** file was included just to show what the default lauch file generated by vscode looks like.

Below are some links to articles I used associated with getting python, pip, and virtualenv installed with PowerShell and VS Code configuration

links:

[1] [How To Install Python, pip, and virtualenv on Windows with PowerShell](http://www.tylerbutler.com/2012/05/how-to-install-python-pip-and-virtualenv-on-windows-with-powershell/)

[2] [SETTING UP PYTHON AND VIRTUAL ENVIRONMENTS IN VISUAL STUDIO CODE](http://dacrook.com/setting-up-python-and-virtual-environments-in-visual-studio-code-on-ubuntu/)

[3] [Python and VS Code](http://mahugh.com/2016/04/27/python-and-vs-code/)

[4] [DonJayamanne Python Path and Version](https://github.com/DonJayamanne/pythonVSCode/wiki/Python-Path-and-Version)

[5] [Getting Started with VS Code User and Workspace Settings](https://code.visualstudio.com/docs/getstarted/settings)

[6] [Integrate with External Tools via VS Code Tasks](https://code.visualstudio.com/docs/editor/tasks)

[7] [Debugging with VS Code](https://code.visualstudio.com/docs/editor/debugging)

